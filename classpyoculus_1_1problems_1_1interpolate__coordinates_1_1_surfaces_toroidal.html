<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>pyoculus: pyoculus.problems.interpolate_coordinates.SurfacesToroidal Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">pyoculus<span id="projectnumber">&#160;0.1.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">pyoculus.problems.interpolate_coordinates.SurfacesToroidal Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Toroidal surfaces object Define surfaces \(s(\vartheta, \zeta) \) and the angle transformations \( \theta (\vartheta, \zeta) \).  
 <a href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal_1_1_coords_output.html">CoordsOutput</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output class.  <a href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal_1_1_coords_output.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a77a34f8d29a8943e3ab7f99262d70e12"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#a77a34f8d29a8943e3ab7f99262d70e12">__init__</a> (self, <a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#a191255e23eb8482558687b7f1d821a82">nsurfaces</a>=2, <a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#a63683a06d6354766e9acc58ad51d714f">mpol</a>=10, <a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#aab1b25b26cb9a68d82870c2c12118ab7">ntor</a>=10, <a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#afe02b7501a450640a0ee7b4ece28dce6">Nfp</a>=1, stellar_sym=True)</td></tr>
<tr class="memdesc:a77a34f8d29a8943e3ab7f99262d70e12"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise the toroidal surface object.  <a href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#a77a34f8d29a8943e3ab7f99262d70e12">More...</a><br /></td></tr>
<tr class="separator:a77a34f8d29a8943e3ab7f99262d70e12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13b8dc05b114d09b0d353281abf9f054"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#a13b8dc05b114d09b0d353281abf9f054">add_surface</a> (self, float rho, <a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#ad034ed112b96733b42583db144f2f4df">scn</a>, <a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#ad874f6fa56536bf060d85d15b5a5c195">tsn</a>, <a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#a5157f9180ad363df81c162bfb95647f3">ssn</a>=None, <a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#a58ed47bc7b1055e6312ebae7478ce61f">tcn</a>=None)</td></tr>
<tr class="memdesc:a13b8dc05b114d09b0d353281abf9f054"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adding a surface into the system with radial label rho.  <a href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#a13b8dc05b114d09b0d353281abf9f054">More...</a><br /></td></tr>
<tr class="separator:a13b8dc05b114d09b0d353281abf9f054"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcb604ab9628b573bf859aefb3ad146c"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#afcb604ab9628b573bf859aefb3ad146c">replace_surface</a> (self, int idx, float rho=None, <a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#ad034ed112b96733b42583db144f2f4df">scn</a>=None, <a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#ad874f6fa56536bf060d85d15b5a5c195">tsn</a>=None, <a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#a5157f9180ad363df81c162bfb95647f3">ssn</a>=None, <a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#a58ed47bc7b1055e6312ebae7478ce61f">tcn</a>=None)</td></tr>
<tr class="memdesc:afcb604ab9628b573bf859aefb3ad146c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Replacing a surface by the new one.  <a href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#afcb604ab9628b573bf859aefb3ad146c">More...</a><br /></td></tr>
<tr class="separator:afcb604ab9628b573bf859aefb3ad146c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb50eb1ffef5319da73665d2b584c6e0"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#aeb50eb1ffef5319da73665d2b584c6e0">get_coords</a> (self, sarr=[0], tarr=[0], zarr=[0], derivative=0, input1D=True)</td></tr>
<tr class="memdesc:aeb50eb1ffef5319da73665d2b584c6e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the coordinates and their derivatives given \(\rho, \vartheta, \zeta\).  <a href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#aeb50eb1ffef5319da73665d2b584c6e0">More...</a><br /></td></tr>
<tr class="separator:aeb50eb1ffef5319da73665d2b584c6e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a653bd63c2a07dcecaa67204e9c98fc3f"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#a653bd63c2a07dcecaa67204e9c98fc3f">jacobi_transform</a> (self, jacobi, <a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal_1_1_coords_output.html">CoordsOutput</a> coords)</td></tr>
<tr class="memdesc:a653bd63c2a07dcecaa67204e9c98fc3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the derivatives wrt the new coordinate given the derivatives in the old coordinates.  <a href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#a653bd63c2a07dcecaa67204e9c98fc3f">More...</a><br /></td></tr>
<tr class="separator:a653bd63c2a07dcecaa67204e9c98fc3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fa6469d9d6a5a9686ff892087b6ffa8"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#a8fa6469d9d6a5a9686ff892087b6ffa8">metric_transform</a> (self, g, <a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal_1_1_coords_output.html">CoordsOutput</a> coords)</td></tr>
<tr class="memdesc:a8fa6469d9d6a5a9686ff892087b6ffa8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the coordinate transformation for a metric tensor \(g_{ij}\) (lower!) (derivative computation under construction)  <a href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#a8fa6469d9d6a5a9686ff892087b6ffa8">More...</a><br /></td></tr>
<tr class="separator:a8fa6469d9d6a5a9686ff892087b6ffa8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bb33cfcd3a53e3e5381d7641e417152"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#a7bb33cfcd3a53e3e5381d7641e417152">contra_vector_transform</a> (self, v, <a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal_1_1_coords_output.html">CoordsOutput</a> coords, has_jacobian=False, derivative=False, dv=None)</td></tr>
<tr class="memdesc:a7bb33cfcd3a53e3e5381d7641e417152"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the coordinate transformation for a contravariant vector \(v^i\) (upper!)  <a href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#a7bb33cfcd3a53e3e5381d7641e417152">More...</a><br /></td></tr>
<tr class="separator:a7bb33cfcd3a53e3e5381d7641e417152"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc615fb78474166a13ed6a0084656216"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#abc615fb78474166a13ed6a0084656216">construct_interpolant</a> (self, <a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#ac144a8f3a0605b6c75cf57378eff55c4">rhosurfs</a>=None, method=&quot;cubic_spline&quot;, **kwargs)</td></tr>
<tr class="memdesc:abc615fb78474166a13ed6a0084656216"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct the interpolant between surfaces for the given method.  <a href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#abc615fb78474166a13ed6a0084656216">More...</a><br /></td></tr>
<tr class="separator:abc615fb78474166a13ed6a0084656216"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c9dfce0028b313b0b6a5f1dcd8cd7db"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#a3c9dfce0028b313b0b6a5f1dcd8cd7db">plot</a> (self, zeta=0, npoints=129, **kwargs)</td></tr>
<tr class="memdesc:a3c9dfce0028b313b0b6a5f1dcd8cd7db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Plot the surfaces.  <a href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#a3c9dfce0028b313b0b6a5f1dcd8cd7db">More...</a><br /></td></tr>
<tr class="separator:a3c9dfce0028b313b0b6a5f1dcd8cd7db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6e2ac560fac47df3db38277b6a22155"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#aa6e2ac560fac47df3db38277b6a22155">read_surfaces_from_file</a> (self, filename=&quot;data.npz&quot;, Nfp=None)</td></tr>
<tr class="memdesc:aa6e2ac560fac47df3db38277b6a22155"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the surfaces into a numpy array on disk.  <a href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#aa6e2ac560fac47df3db38277b6a22155">More...</a><br /></td></tr>
<tr class="separator:aa6e2ac560fac47df3db38277b6a22155"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac005b07bfa5436b8ac4a8d32d13b3280"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#ac005b07bfa5436b8ac4a8d32d13b3280">write_surfaces_to_file</a> (self, filename=&quot;data.npz&quot;)</td></tr>
<tr class="memdesc:ac005b07bfa5436b8ac4a8d32d13b3280"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save the surfaces into a numpy array on disk.  <a href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#ac005b07bfa5436b8ac4a8d32d13b3280">More...</a><br /></td></tr>
<tr class="separator:ac005b07bfa5436b8ac4a8d32d13b3280"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a63683a06d6354766e9acc58ad51d714f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#a63683a06d6354766e9acc58ad51d714f">mpol</a></td></tr>
<tr class="memdesc:a63683a06d6354766e9acc58ad51d714f"><td class="mdescLeft">&#160;</td><td class="mdescRight">The poloidal mode number.  <a href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#a63683a06d6354766e9acc58ad51d714f">More...</a><br /></td></tr>
<tr class="separator:a63683a06d6354766e9acc58ad51d714f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab1b25b26cb9a68d82870c2c12118ab7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#aab1b25b26cb9a68d82870c2c12118ab7">ntor</a></td></tr>
<tr class="memdesc:aab1b25b26cb9a68d82870c2c12118ab7"><td class="mdescLeft">&#160;</td><td class="mdescRight">The toroidal mode number.  <a href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#aab1b25b26cb9a68d82870c2c12118ab7">More...</a><br /></td></tr>
<tr class="separator:aab1b25b26cb9a68d82870c2c12118ab7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe02b7501a450640a0ee7b4ece28dce6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#afe02b7501a450640a0ee7b4ece28dce6">Nfp</a></td></tr>
<tr class="memdesc:afe02b7501a450640a0ee7b4ece28dce6"><td class="mdescLeft">&#160;</td><td class="mdescRight">The field period.  <a href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#afe02b7501a450640a0ee7b4ece28dce6">More...</a><br /></td></tr>
<tr class="separator:afe02b7501a450640a0ee7b4ece28dce6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7acf4d72509d3726a87da549306401d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#af7acf4d72509d3726a87da549306401d">sym</a></td></tr>
<tr class="memdesc:af7acf4d72509d3726a87da549306401d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stellarator symmetry.  <a href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#af7acf4d72509d3726a87da549306401d">More...</a><br /></td></tr>
<tr class="separator:af7acf4d72509d3726a87da549306401d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a191255e23eb8482558687b7f1d821a82"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#a191255e23eb8482558687b7f1d821a82">nsurfaces</a></td></tr>
<tr class="memdesc:a191255e23eb8482558687b7f1d821a82"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of surfaces.  <a href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#a191255e23eb8482558687b7f1d821a82">More...</a><br /></td></tr>
<tr class="separator:a191255e23eb8482558687b7f1d821a82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac144a8f3a0605b6c75cf57378eff55c4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#ac144a8f3a0605b6c75cf57378eff55c4">rhosurfs</a></td></tr>
<tr class="memdesc:ac144a8f3a0605b6c75cf57378eff55c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">The rho coordinate for each surface.  <a href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#ac144a8f3a0605b6c75cf57378eff55c4">More...</a><br /></td></tr>
<tr class="separator:ac144a8f3a0605b6c75cf57378eff55c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad034ed112b96733b42583db144f2f4df"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#ad034ed112b96733b42583db144f2f4df">scn</a></td></tr>
<tr class="memdesc:ad034ed112b96733b42583db144f2f4df"><td class="mdescLeft">&#160;</td><td class="mdescRight">The cosine coefficients of \(s\), dimension (#interfaces, mpol, 2*ntor+1)  <a href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#ad034ed112b96733b42583db144f2f4df">More...</a><br /></td></tr>
<tr class="separator:ad034ed112b96733b42583db144f2f4df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad874f6fa56536bf060d85d15b5a5c195"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#ad874f6fa56536bf060d85d15b5a5c195">tsn</a></td></tr>
<tr class="memdesc:ad874f6fa56536bf060d85d15b5a5c195"><td class="mdescLeft">&#160;</td><td class="mdescRight">The sine coefficients of \(\vartheta\), dimension (#interfaces, mpol, 2*ntor+1)  <a href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#ad874f6fa56536bf060d85d15b5a5c195">More...</a><br /></td></tr>
<tr class="separator:ad874f6fa56536bf060d85d15b5a5c195"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5157f9180ad363df81c162bfb95647f3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#a5157f9180ad363df81c162bfb95647f3">ssn</a></td></tr>
<tr class="memdesc:a5157f9180ad363df81c162bfb95647f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">The sine coefficients of \(s\), dimension (#interfaces, mpol, 2*ntor+1)  <a href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#a5157f9180ad363df81c162bfb95647f3">More...</a><br /></td></tr>
<tr class="separator:a5157f9180ad363df81c162bfb95647f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58ed47bc7b1055e6312ebae7478ce61f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#a58ed47bc7b1055e6312ebae7478ce61f">tcn</a></td></tr>
<tr class="memdesc:a58ed47bc7b1055e6312ebae7478ce61f"><td class="mdescLeft">&#160;</td><td class="mdescRight">The cosine coefficients of \(\vartheta\), dimension (#interfaces, mpol, 2*ntor+1)  <a href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html#a58ed47bc7b1055e6312ebae7478ce61f">More...</a><br /></td></tr>
<tr class="separator:a58ed47bc7b1055e6312ebae7478ce61f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Toroidal surfaces object Define surfaces \(s(\vartheta, \zeta) \) and the angle transformations \( \theta (\vartheta, \zeta) \). </p>
<p >\(s, \vartheta\) are written in terms of Fourier harmonics </p><p class="formulaDsp">
\[ s(\vartheta, \zeta) = \sum_{m=0}^{\text{mpol}}\sum_{n=-\text{ntor}}^{\text{ntor}} s_{c,m,n} \cos(m \vartheta - n \text{N} \zeta) + s_{s,m,n} \sin(m \vartheta - n \text{N} \zeta), \]
</p>
<p> where \(N = \text{Nfp}\). </p><p class="formulaDsp">
\[ \theta(\vartheta, \zeta) = \vartheta + \sum_{m=0}^{\text{mpol}}\sum_{n=-\text{ntor}}^{\text{ntor}} \theta_{c,m,n} \cos(m \vartheta - n \text{N} \zeta) + \theta_{s,m,n} \sin(m \vartheta - n \text{N} \zeta). \]
</p>
<p> If stellarator symmetry is assumed, then \(s\) will only have cosine components and \(\theta \) will only have sine components.</p>
<p >Each surface is assigned a new radial label \(\rho_i\). Now a new set of coordinates \((\rho, \vartheta, \zeta)\) will be constructed given the relationship \(s(\rho, \vartheta, \zeta), \theta(\rho, \vartheta, \zeta)\). If \(\rho\) is not on one of the known surfaces, an interpolation will be performed on all the Fourier harmonics radially using the method of the user's choice. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a77a34f8d29a8943e3ab7f99262d70e12" name="a77a34f8d29a8943e3ab7f99262d70e12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77a34f8d29a8943e3ab7f99262d70e12">&#9670;&nbsp;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def pyoculus.problems.interpolate_coordinates.SurfacesToroidal.__init__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nsurfaces</em> = <code>2</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mpol</em> = <code>10</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ntor</em> = <code>10</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Nfp</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>stellar_sym</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise the toroidal surface object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mpol</td><td>the poloidal mode number </td></tr>
    <tr><td class="paramname">ntor</td><td>the toroidal mode number </td></tr>
    <tr><td class="paramname">Nfp</td><td>the toroidal periodicity </td></tr>
    <tr><td class="paramname">stellar_sym</td><td>assuming stellarator symmetry or not </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a13b8dc05b114d09b0d353281abf9f054" name="a13b8dc05b114d09b0d353281abf9f054"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13b8dc05b114d09b0d353281abf9f054">&#9670;&nbsp;</a></span>add_surface()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def pyoculus.problems.interpolate_coordinates.SurfacesToroidal.add_surface </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>rho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>scn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tsn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ssn</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tcn</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adding a surface into the system with radial label rho. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rho</td><td>the new coordinate \(\rho\) for this new surface </td></tr>
    <tr><td class="paramname">scn</td><td>the cosine components of \(s(\rho, \vartheta, \zeta)\) </td></tr>
    <tr><td class="paramname">tsn</td><td>the sine components of \(\theta(\rho, \vartheta, \zeta)\) </td></tr>
    <tr><td class="paramname">ssn</td><td>the sine componets of \(s(\rho, \vartheta, \zeta)\) </td></tr>
    <tr><td class="paramname">tcn</td><td>the cosine components of \(\theta(\rho, \vartheta, \zeta)\) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="abc615fb78474166a13ed6a0084656216" name="abc615fb78474166a13ed6a0084656216"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc615fb78474166a13ed6a0084656216">&#9670;&nbsp;</a></span>construct_interpolant()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def pyoculus.problems.interpolate_coordinates.SurfacesToroidal.construct_interpolant </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rhosurfs</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em> = <code>&quot;cubic_spline&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**&#160;</td>
          <td class="paramname"><em>kwargs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct the interpolant between surfaces for the given method. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rhosurfs</td><td>The \(\rho\) coordinates for each surface. If input is None, the default or internally stored will be used. </td></tr>
    <tr><td class="paramname">method</td><td>The method being used, can be one of ['cubic_spline', 'cubic_hermite', 'pchip']. The corresponding scipy class is being used. </td></tr>
    <tr><td class="paramname">**kwargs</td><td>Other parameters passing onto the interpolant constructor </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a7bb33cfcd3a53e3e5381d7641e417152" name="a7bb33cfcd3a53e3e5381d7641e417152"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7bb33cfcd3a53e3e5381d7641e417152">&#9670;&nbsp;</a></span>contra_vector_transform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def pyoculus.problems.interpolate_coordinates.SurfacesToroidal.contra_vector_transform </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal_1_1_coords_output.html">CoordsOutput</a>&#160;</td>
          <td class="paramname"><em>coords</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>has_jacobian</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>derivative</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dv</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the coordinate transformation for a contravariant vector \(v^i\) (upper!) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">v</td><td>the vector \(v^i\) to be transformed, should have the dimension (3,...) </td></tr>
    <tr><td class="paramname">coords</td><td>the output of get_coords, should match the dimension of v </td></tr>
    <tr><td class="paramname">has_jacobian</td><td>if the given vector already contains the jacobian </td></tr>
    <tr><td class="paramname">derivative</td><td>if the derivatives are needed or not. If True, dv is required. </td></tr>
    <tr><td class="paramname">dv</td><td>the derivative of v wrt \((s,\theta,\zeta)\), have the dimension (3 derivatives, 3 component,...) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>voutput, dvoutput, the transformed metric and the derivative wrt \((\rho,\vartheta,\zeta)\)</dd></dl>
<p>The vector transformation is given by </p><p class="formulaDsp">
\[ \left(\begin{array}{c} v^{\rho} \\ v^{\vartheta} \\ v^{\zeta} \end{array}\right) = \mathbf{J}^{-1} \left(\begin{array}{c} v^{{s}} \\ v^{\theta} \\ v^{\zeta} \end{array}\right), \]
</p>
<p> where </p><p class="formulaDsp">
\[ \mathbf{J} = \frac{\partial(s,\theta,\zeta)}{\partial(\rho,\vartheta,\zeta)} \]
</p>
<p> is the Jacobi matrix. For computing the result we use matrix solve instead of matrix inversion.</p>
<p >When the derivative is needed, we note that </p><p class="formulaDsp">
\[ \frac{\partial }{\partial \rho}\mathbf{J} \left(\begin{array}{c} v^{\rho} \\ v^{\vartheta} \\ v^{\zeta} \end{array}\right) +\mathbf{J} \frac{\partial }{\partial \rho}\left(\begin{array}{c} v^{\rho} \\ v^{\vartheta} \\ v^{\zeta} \end{array}\right) = \frac{\partial }{\partial \rho}\left(\begin{array}{c} v^{{s}} \\ v^{\theta} \\ v^{\zeta} \end{array}\right), \]
</p>
<p> therefore </p><p class="formulaDsp">
\[ \frac{\partial}{\partial \rho}\left(\begin{array}{c} v^{\rho} \\ v^{\vartheta} \\ v^{\zeta} \end{array}\right) = \mathbf{J}^{-1} \left[\frac{\partial }{\partial \rho}\left(\begin{array}{c} v^{{s}} \\ v^{\theta} \\ v^{\zeta} \end{array}\right) -\frac{\partial \mathbf{J}}{\partial\rho} \left(\begin{array}{c} v^{\rho} \\ v^{\vartheta} \\ v^{\zeta} \end{array}\right)\right]. \]
</p>
<p >Similarly we can compute the \(\vartheta\) and \(\zeta\) derivatives.</p>
<p >Now, </p><p class="formulaDsp">
\[ \frac{\partial (v^{{s}}, v^{\theta}, v^{\zeta})}{\partial(\rho, \vartheta, \zeta)} = \frac{\partial (v^{{s}}, v^{\theta}, v^{\zeta})}{\partial(s, \theta, \zeta)} \times \frac{\partial(s, \theta, \zeta)}{\partial(\rho, \vartheta, \zeta)} \]
</p>
<p >Summing up </p><p class="formulaDsp">
\[ \frac{\partial ( v^{\rho}, v^{\vartheta}, v^{\zeta})}{\partial(\rho, \vartheta, \zeta)} = \mathbf{J}^{-1} \cdot \frac{\partial (v^{{s}}, v^{\theta}, v^{\zeta})}{\partial(s, \theta, \zeta)} \cdot \mathbf{J} - \mathbf{J}^{-1} \cdot (\mathbf{J}_\rho, \mathbf{J}_\vartheta, \mathbf{J}_\zeta) \cdot \left(\begin{array}{c} v^{\rho} \\ v^{\vartheta} \\ v^{\zeta} \end{array}\right) \]
</p>
 
</div>
</div>
<a id="aeb50eb1ffef5319da73665d2b584c6e0" name="aeb50eb1ffef5319da73665d2b584c6e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb50eb1ffef5319da73665d2b584c6e0">&#9670;&nbsp;</a></span>get_coords()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def pyoculus.problems.interpolate_coordinates.SurfacesToroidal.get_coords </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sarr</em> = <code>[0]</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tarr</em> = <code>[0]</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>zarr</em> = <code>[0]</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>derivative</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>input1D</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the coordinates and their derivatives given \(\rho, \vartheta, \zeta\). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sarr</td><td>\(\rho\), an array </td></tr>
    <tr><td class="paramname">tarr</td><td>\(\vartheta\), an array </td></tr>
    <tr><td class="paramname">zarr</td><td>\(\zeta\), an array </td></tr>
    <tr><td class="paramname">derivative</td><td>0:only return \(s, \theta\), 1: also return the derivatives, 2: also return the second derivatives </td></tr>
    <tr><td class="paramname">input1D</td><td>if False, create a meshgrid with sarr, tarr and zarr, if True, treat them as a list of points </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>coords coords.s, coords.t contains the coordinates \(s,\theta\). coords.ds and dt contains the first derivatives. coords.dds and ddt contains second derivates. coords.jacobi contains the jacobi matrix \(J = \partial(s,\theta,\zeta)/\partial(\rho,\vartheta,\zeta)\), coords.djacobi contains the derivative. </dd></dl>

</div>
</div>
<a id="a653bd63c2a07dcecaa67204e9c98fc3f" name="a653bd63c2a07dcecaa67204e9c98fc3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a653bd63c2a07dcecaa67204e9c98fc3f">&#9670;&nbsp;</a></span>jacobi_transform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def pyoculus.problems.interpolate_coordinates.SurfacesToroidal.jacobi_transform </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>jacobi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal_1_1_coords_output.html">CoordsOutput</a>&#160;</td>
          <td class="paramname"><em>coords</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the derivatives wrt the new coordinate given the derivatives in the old coordinates. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jacobi</td><td>the Jacobi matrix \(\partial(f_1, \cdots, f_N) / \partial (s,\theta,\zeta)\) </td></tr>
    <tr><td class="paramname">coords</td><td>the output of get_coords, should match the dimension of J </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>jacobi_output the transformed Jacobi matrix and the derivatives wrt \((\rho,\vartheta,\zeta)\)</dd></dl>
<p>Given \(N\) variables \(f_1, \cdots, f_N \), the jacobi matrix (derivatives wrt the new coordinate is given by the chain rule </p><p class="formulaDsp">
\[ \frac{\partial(f_1, \cdots, f_N)}{\partial(\rho, \vartheta, \zeta)} = \frac{\partial(f_1, \cdots, f_N)}{\partial(s, \theta, \zeta)} \cdot \frac{\partial(s, \theta, \zeta)}{\partial(\rho, \vartheta, \zeta)} \]
</p>
 
</div>
</div>
<a id="a8fa6469d9d6a5a9686ff892087b6ffa8" name="a8fa6469d9d6a5a9686ff892087b6ffa8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fa6469d9d6a5a9686ff892087b6ffa8">&#9670;&nbsp;</a></span>metric_transform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def pyoculus.problems.interpolate_coordinates.SurfacesToroidal.metric_transform </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal_1_1_coords_output.html">CoordsOutput</a>&#160;</td>
          <td class="paramname"><em>coords</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the coordinate transformation for a metric tensor \(g_{ij}\) (lower!) (derivative computation under construction) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">g</td><td>the metric \(g_{ij}\) of the old coordinate \((s,\theta,\zeta)\) to be transformed, should have the dimension (3,3,...) </td></tr>
    <tr><td class="paramname">coords</td><td>the output of get_coords, should match the dimension of g </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>goutput, [dgoutput], the transformed metric and the derivative wrt \((\rho,\vartheta,\zeta)\)</dd></dl>
<p>Let the input metric for \((s, \theta, \zeta)\) being \(\mathbf{g}\), the metric for \((\rho, \vartheta, \zeta)\) is given by </p><p class="formulaDsp">
\[ \mathbf{G} = \mathbf{J}^T \mathbf{g} \mathbf{J}, \]
</p>
<p> where </p><p class="formulaDsp">
\[ \mathbf{J} = \frac{\partial(s,\theta,\zeta)}{\partial(\rho,\vartheta,\zeta)} \]
</p>
<p> is the Jacobi matrix. </p>

</div>
</div>
<a id="a3c9dfce0028b313b0b6a5f1dcd8cd7db" name="a3c9dfce0028b313b0b6a5f1dcd8cd7db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c9dfce0028b313b0b6a5f1dcd8cd7db">&#9670;&nbsp;</a></span>plot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def pyoculus.problems.interpolate_coordinates.SurfacesToroidal.plot </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>zeta</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>npoints</em> = <code>129</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**&#160;</td>
          <td class="paramname"><em>kwargs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Plot the surfaces. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">zeta</td><td>the toroidal plane </td></tr>
    <tr><td class="paramname">npoints</td><td>the number of points in the plot </td></tr>
    <tr><td class="paramname">**kwargs</td><td>all other parameters going into plt.plot </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa6e2ac560fac47df3db38277b6a22155" name="aa6e2ac560fac47df3db38277b6a22155"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6e2ac560fac47df3db38277b6a22155">&#9670;&nbsp;</a></span>read_surfaces_from_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def pyoculus.problems.interpolate_coordinates.SurfacesToroidal.read_surfaces_from_file </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>filename</em> = <code>&quot;data.npz&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Nfp</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read the surfaces into a numpy array on disk. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>the filename to load from </td></tr>
    <tr><td class="paramname">Nfp</td><td>the toroidal periodicity, if known. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="afcb604ab9628b573bf859aefb3ad146c" name="afcb604ab9628b573bf859aefb3ad146c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcb604ab9628b573bf859aefb3ad146c">&#9670;&nbsp;</a></span>replace_surface()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def pyoculus.problems.interpolate_coordinates.SurfacesToroidal.replace_surface </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float &#160;</td>
          <td class="paramname"><em>rho</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>scn</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tsn</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ssn</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tcn</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Replacing a surface by the new one. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">idx</td><td>the index of the surface to be replaced </td></tr>
    <tr><td class="paramname">rho</td><td>the new coordinate \(\rho\) for this new surface. If this is None then keep same. </td></tr>
    <tr><td class="paramname">scn</td><td>the cosine components of \(s(\rho, \vartheta, \zeta)\). If this is None then keep same. </td></tr>
    <tr><td class="paramname">tsn</td><td>the sine components of \(\theta(\rho, \vartheta, \zeta)\). If this is None then keep same. </td></tr>
    <tr><td class="paramname">ssn</td><td>the sine componets of \(s(\rho, \vartheta, \zeta)\). If this is None then keep same. </td></tr>
    <tr><td class="paramname">tcn</td><td>the cosine components of \(\theta(\rho, \vartheta, \zeta)\). If this is None then keep same. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac005b07bfa5436b8ac4a8d32d13b3280" name="ac005b07bfa5436b8ac4a8d32d13b3280"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac005b07bfa5436b8ac4a8d32d13b3280">&#9670;&nbsp;</a></span>write_surfaces_to_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def pyoculus.problems.interpolate_coordinates.SurfacesToroidal.write_surfaces_to_file </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>filename</em> = <code>&quot;data.npz&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Save the surfaces into a numpy array on disk. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>the filename to save to </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a63683a06d6354766e9acc58ad51d714f" name="a63683a06d6354766e9acc58ad51d714f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63683a06d6354766e9acc58ad51d714f">&#9670;&nbsp;</a></span>mpol</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pyoculus.problems.interpolate_coordinates.SurfacesToroidal.mpol</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The poloidal mode number. </p>

</div>
</div>
<a id="afe02b7501a450640a0ee7b4ece28dce6" name="afe02b7501a450640a0ee7b4ece28dce6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe02b7501a450640a0ee7b4ece28dce6">&#9670;&nbsp;</a></span>Nfp</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pyoculus.problems.interpolate_coordinates.SurfacesToroidal.Nfp</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The field period. </p>

</div>
</div>
<a id="a191255e23eb8482558687b7f1d821a82" name="a191255e23eb8482558687b7f1d821a82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a191255e23eb8482558687b7f1d821a82">&#9670;&nbsp;</a></span>nsurfaces</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pyoculus.problems.interpolate_coordinates.SurfacesToroidal.nsurfaces</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of surfaces. </p>

</div>
</div>
<a id="aab1b25b26cb9a68d82870c2c12118ab7" name="aab1b25b26cb9a68d82870c2c12118ab7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab1b25b26cb9a68d82870c2c12118ab7">&#9670;&nbsp;</a></span>ntor</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pyoculus.problems.interpolate_coordinates.SurfacesToroidal.ntor</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The toroidal mode number. </p>

</div>
</div>
<a id="ac144a8f3a0605b6c75cf57378eff55c4" name="ac144a8f3a0605b6c75cf57378eff55c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac144a8f3a0605b6c75cf57378eff55c4">&#9670;&nbsp;</a></span>rhosurfs</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pyoculus.problems.interpolate_coordinates.SurfacesToroidal.rhosurfs</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The rho coordinate for each surface. </p>

</div>
</div>
<a id="ad034ed112b96733b42583db144f2f4df" name="ad034ed112b96733b42583db144f2f4df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad034ed112b96733b42583db144f2f4df">&#9670;&nbsp;</a></span>scn</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pyoculus.problems.interpolate_coordinates.SurfacesToroidal.scn</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The cosine coefficients of \(s\), dimension (#interfaces, mpol, 2*ntor+1) </p>

</div>
</div>
<a id="a5157f9180ad363df81c162bfb95647f3" name="a5157f9180ad363df81c162bfb95647f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5157f9180ad363df81c162bfb95647f3">&#9670;&nbsp;</a></span>ssn</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pyoculus.problems.interpolate_coordinates.SurfacesToroidal.ssn</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The sine coefficients of \(s\), dimension (#interfaces, mpol, 2*ntor+1) </p>

</div>
</div>
<a id="af7acf4d72509d3726a87da549306401d" name="af7acf4d72509d3726a87da549306401d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7acf4d72509d3726a87da549306401d">&#9670;&nbsp;</a></span>sym</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pyoculus.problems.interpolate_coordinates.SurfacesToroidal.sym</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stellarator symmetry. </p>

</div>
</div>
<a id="a58ed47bc7b1055e6312ebae7478ce61f" name="a58ed47bc7b1055e6312ebae7478ce61f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58ed47bc7b1055e6312ebae7478ce61f">&#9670;&nbsp;</a></span>tcn</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pyoculus.problems.interpolate_coordinates.SurfacesToroidal.tcn</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The cosine coefficients of \(\vartheta\), dimension (#interfaces, mpol, 2*ntor+1) </p>

</div>
</div>
<a id="ad874f6fa56536bf060d85d15b5a5c195" name="ad874f6fa56536bf060d85d15b5a5c195"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad874f6fa56536bf060d85d15b5a5c195">&#9670;&nbsp;</a></span>tsn</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pyoculus.problems.interpolate_coordinates.SurfacesToroidal.tsn</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The sine coefficients of \(\vartheta\), dimension (#interfaces, mpol, 2*ntor+1) </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>pyoculus/problems/<a class="el" href="interpolate__coordinates_8py.html">interpolate_coordinates.py</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacepyoculus.html">pyoculus</a></li><li class="navelem"><a class="el" href="namespacepyoculus_1_1problems.html">problems</a></li><li class="navelem"><a class="el" href="namespacepyoculus_1_1problems_1_1interpolate__coordinates.html">interpolate_coordinates</a></li><li class="navelem"><a class="el" href="classpyoculus_1_1problems_1_1interpolate__coordinates_1_1_surfaces_toroidal.html">SurfacesToroidal</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
