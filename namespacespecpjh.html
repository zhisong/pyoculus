<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>pyoculus: specpjh Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">pyoculus<span id="projectnumber">&#160;0.1.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('namespacespecpjh.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle"><div class="title">specpjh Module Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Fortran module for SPEC Pressure Jump Hamiltonian problems.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a1aa07329218a9bfc3d5c6dda9e15583e" id="r_a1aa07329218a9bfc3d5c6dda9e15583e"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1aa07329218a9bfc3d5c6dda9e15583e">get_pjhfield</a> (phi, ptt, dptt)</td></tr>
<tr class="memdesc:a1aa07329218a9bfc3d5c6dda9e15583e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the ODEs for PJH system, \(dp_\theta/d\varphi\), \(d\theta/d\varphi\).  <br /></td></tr>
<tr class="separator:a1aa07329218a9bfc3d5c6dda9e15583e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa721f885bb3eef78de7dcf0e3194cd77" id="r_aa721f885bb3eef78de7dcf0e3194cd77"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa721f885bb3eef78de7dcf0e3194cd77">get_pjhfield_tangent</a> (phi, ptt, dptt)</td></tr>
<tr class="memdesc:aa721f885bb3eef78de7dcf0e3194cd77"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the ODEs for PJH system, \(dp_\theta/d\varphi\), \(d\theta/d\varphi\), with tangent.  <br /></td></tr>
<tr class="separator:aa721f885bb3eef78de7dcf0e3194cd77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75701a8e555d3c2e5749a6e2fb3a54b5" id="r_a75701a8e555d3c2e5749a6e2fb3a54b5"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a75701a8e555d3c2e5749a6e2fb3a54b5">get_covariant_field</a> (theta, phi, bco)</td></tr>
<tr class="memdesc:a75701a8e555d3c2e5749a6e2fb3a54b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the covariant component of known side of magnetic field \(\bf B_1\), i.e. \(B_{1,\theta}, B_{1,\varphi}\). Can be used to estimate the initial condition for \(p_\theta\).  <br /></td></tr>
<tr class="separator:a75701a8e555d3c2e5749a6e2fb3a54b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d5eff8690a6cdac360f43cbd5183685" id="r_a4d5eff8690a6cdac360f43cbd5183685"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4d5eff8690a6cdac360f43cbd5183685">get_b2_interface</a> (db2, ioi, theta, phi, guvij, sg, ideriv)</td></tr>
<tr class="memdesc:a4d5eff8690a6cdac360f43cbd5183685"><td class="mdescLeft">&#160;</td><td class="mdescRight">An internal subroutine that computes the squared magnetic field strength on the interface \(B_1^2\) and its first and second \(\theta\) derivatives. This is a private subroutine that is not interfaced with Python.  <br /></td></tr>
<tr class="separator:a4d5eff8690a6cdac360f43cbd5183685"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa11c5ee3a60b1fa911ead2e05a89ff59" id="r_aa11c5ee3a60b1fa911ead2e05a89ff59"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa11c5ee3a60b1fa911ead2e05a89ff59">init_pjh</a> (dp, inside_or_outside, plus_or_minus)</td></tr>
<tr class="memdesc:aa11c5ee3a60b1fa911ead2e05a89ff59"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the PJH system. Whenever \(\delta p\) is modified, you will need to call this subroutine (in Python interface) again.  <br /></td></tr>
<tr class="separator:aa11c5ee3a60b1fa911ead2e05a89ff59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e69307ec6a4e755796b1746edbb8e88" id="r_a6e69307ec6a4e755796b1746edbb8e88"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6e69307ec6a4e755796b1746edbb8e88">destroy_pjh</a> ()</td></tr>
<tr class="memdesc:a6e69307ec6a4e755796b1746edbb8e88"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine frees the memory space allocated by <a class="el" href="#aa11c5ee3a60b1fa911ead2e05a89ff59" title="Initialize the PJH system. Whenever  is modified, you will need to call this subroutine (in Python in...">specpjh::init_pjh</a>.  <br /></td></tr>
<tr class="separator:a6e69307ec6a4e755796b1746edbb8e88"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Fortran module for SPEC Pressure Jump Hamiltonian problems. </p>
<dl class="section author"><dt>Author</dt><dd>Stuart Hudson (<a href="#" onclick="location.href='mai'+'lto:'+'shu'+'ds'+'on@'+'pp'+'pl.'+'go'+'v'; return false;">shuds<span class="obfuscator">.nosp@m.</span>on@p<span class="obfuscator">.nosp@m.</span>ppl.g<span class="obfuscator">.nosp@m.</span>ov</a>) </dd>
<dd>
Adapted by Zhisong Qu (<a href="#" onclick="location.href='mai'+'lto:'+'zhi'+'so'+'ng.'+'qu'+'@an'+'u.'+'edu'+'.a'+'u'; return false;">zhiso<span class="obfuscator">.nosp@m.</span>ng.q<span class="obfuscator">.nosp@m.</span>u@anu<span class="obfuscator">.nosp@m.</span>.edu<span class="obfuscator">.nosp@m.</span>.au</a>)</dd></dl>
<p>Interfaced to Python, see pyoculus.problems.SPECPJH.SPECPJH</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">Todo</a></b></dt><dd>non-stellarator symmetric cases</dd></dl>
<h2><a class="anchor" id="autotoc_md19"></a>
Pressure Jump Hamiltonian (PJH) Fortran module</h2>
<p>Please note that in the Python module pyoculus.problems.SPECPJH.SPECPJH, \(\zeta\) is equivalent to \(\varphi\)</p>
<h3><a class="anchor" id="autotoc_md20"></a>
Usage in Python:</h3>
<p>To use the pjh module, one needs to initialize the fortran module first in Python (using class pyoculus.problems.SPECProblem or classes derived from it), then initialize pjh in Python by calling its Python wrap in <code>pyoculus.problems.SPECfortran.fortran_module</code> </p><pre class="fragment">init_pjh(dp, inside_or_outside, plus_or_minus)
</pre><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dp</td><td>\(\delta p\), the pressure jump </td></tr>
    <tr><td class="paramname">inside_or_outside</td><td>for the specified volume, we compute things on the inner interface or outer </td></tr>
    <tr><td class="paramname">plus_or_minus</td><td>whether to take the plus or minus sign in computing \(p_\varphi\)</td></tr>
  </table>
  </dd>
</dl>
<p>After initialization, one can call </p><pre class="fragment">rhs = get_pjhfield(phi, ptt)
</pre><p>or for rhs and tangent, </p><pre class="fragment">rhs = get_pjhfield_tangent(phi, ptt)
</pre><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">phi</td><td>the \(\varphi\) angle </td></tr>
    <tr><td class="paramname">ptt</td><td>the state vector ( \(p_\theta\), \(\theta\)), or ( \(p_\theta\), \(\theta\), dp1, dt1, dp2, dt2) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array of size 2 (for get_pjhfield) or array of size 6 (for get_pjhfield_tangent)</dd></dl>
<p>To estimate the initial value for \(p_\theta\), sometimes we need \(B_\theta\) on the known side of the interface. This can be obtained by calling </p><pre class="fragment">(Btheta, Bphi) = get_covariant_field(theta, phi)
</pre><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">theta</td><td>\(\theta\) </td></tr>
    <tr><td class="paramname">phi</td><td>\(\varphi\) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the covariant component on the known side of the interface, \((B_{1,\theta}, B_{1,\varphi})\) </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a6e69307ec6a4e755796b1746edbb8e88" name="a6e69307ec6a4e755796b1746edbb8e88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e69307ec6a4e755796b1746edbb8e88">&#9670;&#160;</a></span>destroy_pjh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public specpjh::destroy_pjh</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine frees the memory space allocated by <a class="el" href="#aa11c5ee3a60b1fa911ead2e05a89ff59" title="Initialize the PJH system. Whenever  is modified, you will need to call this subroutine (in Python in...">specpjh::init_pjh</a>. </p>

</div>
</div>
<a id="a4d5eff8690a6cdac360f43cbd5183685" name="a4d5eff8690a6cdac360f43cbd5183685"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d5eff8690a6cdac360f43cbd5183685">&#9670;&#160;</a></span>get_b2_interface()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public specpjh::get_b2_interface </td>
          <td>(</td>
          <td class="paramtype">real(kind=real_kind), dimension(0:2), intent(out)</td>          <td class="paramname"><span class="paramname"><em>db2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)</td>          <td class="paramname"><span class="paramname"><em>ioi</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=real_kind), intent(in)</td>          <td class="paramname"><span class="paramname"><em>theta</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=real_kind), intent(in)</td>          <td class="paramname"><span class="paramname"><em>phi</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=real_kind), dimension(3,3,0:2), intent(in)</td>          <td class="paramname"><span class="paramname"><em>guvij</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=real_kind), dimension(0:2), intent(in)</td>          <td class="paramname"><span class="paramname"><em>sg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)</td>          <td class="paramname"><span class="paramname"><em>ideriv</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>An internal subroutine that computes the squared magnetic field strength on the interface \(B_1^2\) and its first and second \(\theta\) derivatives. This is a private subroutine that is not interfaced with Python. </p>

</div>
</div>
<a id="a75701a8e555d3c2e5749a6e2fb3a54b5" name="a75701a8e555d3c2e5749a6e2fb3a54b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75701a8e555d3c2e5749a6e2fb3a54b5">&#9670;&#160;</a></span>get_covariant_field()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public specpjh::get_covariant_field </td>
          <td>(</td>
          <td class="paramtype">real(kind=real_kind), intent(in)</td>          <td class="paramname"><span class="paramname"><em>theta</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=real_kind), intent(in)</td>          <td class="paramname"><span class="paramname"><em>phi</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=real_kind), dimension(2), intent(out)</td>          <td class="paramname"><span class="paramname"><em>bco</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the covariant component of known side of magnetic field \(\bf B_1\), i.e. \(B_{1,\theta}, B_{1,\varphi}\). Can be used to estimate the initial condition for \(p_\theta\). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">theta</td><td>the \(\theta\) angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">phi</td><td>the \(\phi\) angle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">bco</td><td>the covariant components ( \(B_{1,\theta}, B_{1,\varphi}\)) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1aa07329218a9bfc3d5c6dda9e15583e" name="a1aa07329218a9bfc3d5c6dda9e15583e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1aa07329218a9bfc3d5c6dda9e15583e">&#9670;&#160;</a></span>get_pjhfield()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public specpjh::get_pjhfield </td>
          <td>(</td>
          <td class="paramtype">real(kind=real_kind), intent(in)</td>          <td class="paramname"><span class="paramname"><em>phi</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=real_kind), dimension(2), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ptt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=real_kind), dimension(2), intent(out)</td>          <td class="paramname"><span class="paramname"><em>dptt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the ODEs for PJH system, \(dp_\theta/d\varphi\), \(d\theta/d\varphi\). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">phi</td><td>the \(\varphi\) angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ptt</td><td>( \(p_\theta\), \(\theta\)) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dptt</td><td>( \(dp_\theta/d\varphi\), \(d\theta/d\varphi\)) </td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>We need the metrics \(g_{\theta \theta}, g_{\theta \varphi}, g_{\varphi \varphi}\) and the Jacobian \(J\), as well as their first \(\theta\) derivatives by calling the subroutine coords::get_metric_interface</li>
</ul>
<ul>
<li>Compute \( G \) and its derivatives.</li>
</ul>
<ul>
<li>Compute the squared magnetic field strength \(B_1^2\) on the other side of the interface by calling the subroutine <a class="el" href="#a4d5eff8690a6cdac360f43cbd5183685" title="An internal subroutine that computes the squared magnetic field strength on the interface  and its fi...">specpjh::get_b2_interface</a></li>
</ul>
<ul>
<li>Construct \(a, b, c\) for the quadratic equation for solving \(p_\varphi\), then solve it by applying plus_or_minus sign we specified earlier (stored in dP)</li>
</ul>
<ul>
<li>Computes \(b_2\)</li>
</ul>
<ul>
<li>Construct the denominator of \(d\theta/d\varphi\)</li>
</ul>
<ul>
<li>Construct the numerators</li>
</ul>
<ul>
<li>Get right hand side</li>
</ul>

</div>
</div>
<a id="aa721f885bb3eef78de7dcf0e3194cd77" name="aa721f885bb3eef78de7dcf0e3194cd77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa721f885bb3eef78de7dcf0e3194cd77">&#9670;&#160;</a></span>get_pjhfield_tangent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public specpjh::get_pjhfield_tangent </td>
          <td>(</td>
          <td class="paramtype">real(kind=real_kind), intent(in)</td>          <td class="paramname"><span class="paramname"><em>phi</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=real_kind), dimension(6), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ptt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=real_kind), dimension(6), intent(out)</td>          <td class="paramname"><span class="paramname"><em>dptt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the ODEs for PJH system, \(dp_\theta/d\varphi\), \(d\theta/d\varphi\), with tangent. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">phi</td><td>the \(\varphi\) angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ptt</td><td>( \(p_\theta\), \(\theta\), \(\Delta p_{\theta,1}\), \(\Delta \theta_1\), \(\Delta p_{\theta,2}\), \(\Delta \theta_2\)) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dptt</td><td>( \(dp_\theta/d\varphi\), \(d\theta/d\varphi\)) </td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>We need the metrics \(g_{\theta \theta}, g_{\theta \varphi}, g_{\varphi \varphi}\) and the Jacobian \(J\), as well as their first \(\theta\) derivatives by calling the subroutine coords::get_metric_interface</li>
</ul>
<ul>
<li>Compute \( G \) and its derivatives.</li>
</ul>
<ul>
<li>Compute the squared magnetic field strength \(B_1^2\) on the other side of the interface by calling the subroutine <a class="el" href="#a4d5eff8690a6cdac360f43cbd5183685" title="An internal subroutine that computes the squared magnetic field strength on the interface  and its fi...">specpjh::get_b2_interface</a></li>
</ul>
<ul>
<li>Construct \(a, b, c\) for the quadratic equation for solving \(p_\varphi\), then solve it by applying plus_or_minus sign we specified earlier (stored in dP)</li>
</ul>
<ul>
<li>Computes \(b_2\)</li>
</ul>
<ul>
<li>Construct the denominator of \(d\theta/d\varphi\)</li>
</ul>
<ul>
<li>Construct the numerators</li>
</ul>
<ul>
<li>Get right hand side</li>
</ul>

</div>
</div>
<a id="aa11c5ee3a60b1fa911ead2e05a89ff59" name="aa11c5ee3a60b1fa911ead2e05a89ff59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa11c5ee3a60b1fa911ead2e05a89ff59">&#9670;&#160;</a></span>init_pjh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public specpjh::init_pjh </td>
          <td>(</td>
          <td class="paramtype">real(kind=real_kind), intent(in)</td>          <td class="paramname"><span class="paramname"><em>dp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)</td>          <td class="paramname"><span class="paramname"><em>inside_or_outside</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)</td>          <td class="paramname"><span class="paramname"><em>plus_or_minus</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the PJH system. Whenever \(\delta p\) is modified, you will need to call this subroutine (in Python interface) again. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dp</td><td>the pressure jump \(\delta p\) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inside_or_outside</td><td>0 for inside interface of the selected volume ivol (set in SPECvariables::ivol), +1 for outside </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">plus_or_minus</td><td>set the sign (-1 or +1) for computing \(p_\varphi\) using the quadratic root equation. </td></tr>
  </table>
  </dd>
</dl>
<p>The contravariant component of \(\bf B_1\) is computed on the interface. The Fourier components of \( J B^{\theta}_1\) and \( J B^{\varphi}_1\) are stored for further use.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacespecpjh.html">specpjh</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
